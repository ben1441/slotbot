"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkSignature = void 0;
const crypto_1 = require("crypto");
function checkSignature(token, { hash, ...data }) {
    const secret = (0, crypto_1.createHash)("sha256")
        .update(token)
        .digest();
    const payload = Object.keys(data)
        .sort()
        .map((k) => `${k}=${data[k]}`)
        .join("\n");
    const hmac = (0, crypto_1.createHmac)("sha256", secret)
        .update(payload)
        .digest("hex");
    return hmac === hash;
}
exports.checkSignature = checkSignature;
